import{w as rt}from"./singletons.1d32fb1e.js";import{X as nt}from"./index.2dec55bc.js";function it(e,...t){const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function le(e){let t;return it(e,r=>t=r)(),t}class st extends Error{constructor(t,r){super(t),this.name="FelteSubmitError",this.response=r}}function ot(e,t){return Object.keys(e).some(n=>t(e[n]))}function Ce(e,t){return Object.keys(e||{}).reduce((n,i)=>Object.assign(Object.assign({},n),{[i]:t(e[i])}),{})}function v(e){return Object.prototype.toString.call(e)==="[object Object]"}function K(e){return Object.keys(e||{}).reduce((t,r)=>Object.assign(Object.assign({},t),{[r]:v(e[r])?K(e[r]):Array.isArray(e[r])?[...e[r]]:e[r]}),{})}function at(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function ut(e){return function(t){if(v(t)){const r=B(t,e);return at(r,["key"])}return e}}function B(e,t){return Ce(e,r=>v(r)?B(r,t):Array.isArray(r)?r.map(ut(t)):t)}function he(...e){const t=e.pop(),r=e.shift();if(typeof r=="string")return r;const n=K(r);if(e.length===0)return n;for(const i of e){if(!i)continue;if(typeof i=="string")return i;let s=t(n,i);if(typeof s<"u")return s;const a=Array.from(new Set(Object.keys(n).concat(Object.keys(i))));for(const c of a)if(s=t(n[c],i[c]),typeof s<"u")n[c]=s;else if(v(i[c])&&v(n[c]))n[c]=he(n[c],i[c],t);else if(Array.isArray(i[c]))n[c]=i[c].map((p,h)=>{if(!v(p))return p;const w=Array.isArray(n[c])?n[c][h]:n[c];return he(w,p,t)});else if(v(i[c])){const p=B(K(i[c]),void 0);n[c]=he(p,i[c],t)}else typeof i[c]<"u"&&(n[c]=i[c])}return n}function ct(e,t){if(!(v(e)&&v(t))){if(Array.isArray(t)){if(t.some(v))return;const r=Array.isArray(e)?e:[];return t.map((n,i)=>{var s;return(s=r[i])!==null&&s!==void 0?s:n})}if(typeof e<"u")return e}}function Be(...e){return he(...e,ct)}function Je(...e){return he(...e,()=>{})}function fe(e,t,r){const n=s=>String.prototype.split.call(t,s).filter(Boolean).reduce((a,c)=>a!=null?a[c]:a,e),i=n(/[,[\]]+?/)||n(/[,[\].]+?/);return i===void 0||i===e?r:i}function We(e,t,r){e&&(e=K(e)),v(e)||(e={});const n=Array.isArray(t)?t:t.match(/[^.[\]]+/g)||[],i=n[n.length-1];if(!i)return e;let s=e;for(let a=0;a<n.length-1;a++){const c=n[a];if(!s[c]||!v(s[c])&&!Array.isArray(s[c])){const p=n[a+1];isNaN(Number(p))?s[c]={}:s[c]=[]}s=s[c]}return s[i]=r(s[i]),e}function E(e,t,r){return We(e,t,()=>r)}function Ie(e,t){if(!e||Object(e)!==e)return;typeof e<"u"&&(e=K(e));const r=Array.isArray(t)?t:t.toString().match(/[^.[\]]+/g)||[],n=r.length===1?e:fe(e,r.slice(0,-1).join("."));return Array.isArray(n)?n.splice(Number(r[r.length-1]),1):n==null||delete n[r[r.length-1]],e}function Le(e,t){return ot(e,r=>v(r)?Le(r,t):Array.isArray(r)?r.length===0||r.every(n=>typeof n=="string")?t(r):r.some(n=>v(n)?Le(n,t):t(n)):t(r))}function ke(e){return(e==null?void 0:e.nodeName)==="INPUT"}function lt(e){return(e==null?void 0:e.nodeName)==="TEXTAREA"}function Fe(e){return(e==null?void 0:e.nodeName)==="SELECT"}function He(e){return(e==null?void 0:e.nodeName)==="FIELDSET"}function U(e){return ke(e)||lt(e)||Fe(e)}function ze(e){return e.nodeType===Node.ELEMENT_NODE}function j(e,t){return t??(U(e)?e.name:"")}function Me(e){let t=e;for(;t&&t.nodeName!=="FORM";){if(t.hasAttribute("data-felte-ignore"))return!0;t=t.parentElement}return!1}function dt(e,t){if(!(v(e)||v(t))){if(e===null||e==="")return t;if(t===null||t===""||!t)return e;if(!(!e||!t)){if(Array.isArray(e)){if(!Array.isArray(t))return[...e,t];const r=[],n=Math.max(t.length,e.length);for(let i=0;i<n;i++){let s=e[i],a=t[i];!v(s)&&!v(a)?(Array.isArray(s)||(s=[s]),Array.isArray(a)||(a=[a]),r.push(...s,...a)):r.push(De([s??{},a??{}]))}return r.filter(Boolean)}return Array.isArray(t)||(t=[t]),[e,...t].reduce((r,n)=>r.concat(n),[]).filter(Boolean)}}}function De(e){return he(...e,dt)}function ft(e,t){return t?(Array.isArray(t)?t:[t]).map(n=>n(e)):[]}function $e(e,t){return t?Array.isArray(t)?t.reduce((r,n)=>n(r),e):t(e):e}function Qe(e=8){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let r="";for(let n=0;n<e;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}function Ue(e,t,{onInit:r,onEnd:n}={}){let i;return(...s)=>{i||r==null||r(),i&&clearTimeout(i),i=setTimeout(()=>{e.apply(this,s),i=void 0,n==null||n()},t)}}function qe(e){if(U(e))return[e];if(e.childElementCount===0)return[];const t=new Set;for(const r of e.children){if(U(r)&&t.add(r),He(r))for(const n of r.elements)U(n)&&t.add(n);r.childElementCount>0&&qe(r).forEach(n=>t.add(n))}return Array.from(t)}function Ye(e){for(const t of e.elements)!U(t)&&!He(t)||e.hasAttribute("data-felte-keep-on-remove")&&!t.hasAttribute("data-felte-keep-on-remove")&&(t.dataset.felteKeepOnRemove=e.dataset.felteKeepOnRemove)}function Ze(e){return e.type.match(/^(number|range)$/)?e.value?+e.value:null:e.value}function Xe(e){var t;let r={},n={};for(const i of e.elements){if(He(i)&&Ye(i),!U(i)||!i.name)continue;const s=j(i);if(ke(i)){if(i.type==="checkbox"){if(typeof fe(r,s)>"u"){if(Array.from(e.querySelectorAll(`[name="${i.name}"]`)).filter(p=>U(p)?s===j(p):!1).length===1){r=E(r,s,i.checked),n=E(n,s,!1);continue}r=E(r,s,i.checked?[i.value]:[]),n=E(n,s,!1);continue}Array.isArray(fe(r,s))&&i.checked&&(r=We(r,s,c=>[...c,i.value]));continue}if(i.type==="radio"){if(fe(r,s))continue;r=E(r,s,i.checked?i.value:void 0),n=E(n,s,!1);continue}if(i.type==="file"){r=E(r,s,i.multiple?Array.from(i.files||[]):(t=i.files)===null||t===void 0?void 0:t[0]),n=E(n,s,!1);continue}}else if(Fe(i)){if(!i.multiple)r=E(r,s,i.value);else{const p=Array.from(i.selectedOptions).map(h=>h.value);r=E(r,s,p)}n=E(n,s,!1);continue}const a=Ze(i);r=E(r,s,a),n=E(n,s,!1)}return{defaultData:r,defaultTouched:n}}function mt(e,t){var r;if(!U(e))return;const n=t;if(ke(e)){if(e.type==="checkbox"){const i=n;if(typeof i>"u"||typeof i=="boolean"){e.checked=!!i;return}Array.isArray(i)&&(i.includes(e.value)?e.checked=!0:e.checked=!1);return}if(e.type==="radio"){const i=n;e.value===i?e.checked=!0:e.checked=!1;return}if(e.type==="file"){if(t instanceof FileList)e.files=t;else if(t instanceof File&&typeof DataTransfer<"u"){const i=new DataTransfer;i.items.add(t),e.files=i.files}else if(typeof DataTransfer<"u"&&Array.isArray(t)&&t.some(i=>i instanceof File)){const i=new DataTransfer;for(const s of t)s instanceof File&&i.items.add(s);e.files=i.files}else(!t||Array.isArray(t)&&!t.length)&&(e.files=null,e.value="");return}}else if(Fe(e)){if(e.multiple){if(Array.isArray(n)){e.value=String((r=n[0])!==null&&r!==void 0?r:"");const s=n.map(a=>String(a));for(const a of e.options)s.includes(a.value)?a.selected=!0:a.selected=!1}}else{e.value=String(n??"");for(const s of e.options)s.value===String(n)?s.selected=!0:s.selected=!1}return}e.value=String(n??"")}function Re(e,t){for(const r of e.elements){if(He(r)&&Ye(r),!U(r)||!r.name)continue;const n=j(r);mt(r,fe(t,n))}}function Ve(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function de(e,t){return Ce(e,r=>v(r)?de(r,t):Array.isArray(r)?r.length===0||r.every(n=>typeof n=="string")?t:r.map(n=>{const i=de(n,t);return Ve(i,["key"])}):t)}function Te(e){return e?Ce(e,t=>v(t)?Te(t):Array.isArray(t)?t.length===0||t.every(r=>typeof r=="string")?t:t.map(r=>{if(!v(r))return r;const n=Te(r);return n.key||(n.key=Qe()),n}):t):{}}function _e(e){return e?Ce(e,t=>v(t)?_e(t):Array.isArray(t)?t.length===0||t.every(r=>typeof r=="string")?t:t.map(r=>{if(!v(r))return r;const n=_e(r);return Ve(n,["key"])}):t):{}}function yt(){class e extends CustomEvent{constructor(i){super("feltesuccess",{detail:i})}}class t extends CustomEvent{constructor(i){super("felteerror",{detail:i,cancelable:!0})}setErrors(i){this.preventDefault(),this.errors=i}}class r extends Event{constructor(){super("feltesubmit",{cancelable:!0})}handleSubmit(i){this.onSubmit=i}handleError(i){this.onError=i}handleSuccess(i){this.onSuccess=i}}return{createErrorEvent:n=>new t(n),createSubmitEvent:()=>new r,createSuccessEvent:n=>new e(n)}}function vt(e){if(e)return async function(){let r=new FormData(e);const n=new URL(e.action),i=e.method.toLowerCase()==="get"?"get":n.searchParams.get("_method")||e.method;let s=e.enctype;e.querySelector('input[type="file"]')&&(s="multipart/form-data"),(i==="get"||s==="application/x-www-form-urlencoded")&&(r=new URLSearchParams(r));let a;i==="get"?(r.forEach((p,h)=>{n.searchParams.append(h,p)}),a={method:i,headers:{Accept:"application/json"}}):a={method:i,body:r,headers:Object.assign(Object.assign({},s!=="multipart/form-data"&&{"Content-Type":s}),{Accept:"application/json"})};const c=await window.fetch(n.toString(),a);if(c.ok)return c;throw new st("An error occurred while submitting the form",c)}}function je(e,t,r,n){return We(e,t,i=>(typeof i<"u"&&!Array.isArray(i)||(i||(i=[]),typeof n>"u"?i.push(r):i.splice(n,0,r)),i))}function pt(e,t,r,n){return We(e,t,i=>(!i||!Array.isArray(i)||([i[r],i[n]]=[i[n],i[r]]),i))}function bt(e,t,r,n){return We(e,t,i=>(!i||!Array.isArray(i)||i.splice(n,0,i.splice(r,1)[0]),i))}function Ge(e){return typeof e=="function"}function Ae(e){return(r,n)=>{if(typeof r=="string"){const i=r;e(s=>{const a=Ge(n)?n(fe(s,i)):n;return E(s,i,a)})}else e(i=>Ge(r)?r(i):r)}}function At({stores:e,config:t,validateErrors:r,validateWarnings:n,_getCurrentExtenders:i}){var s;let a,c=Te((s=t.initialValues)!==null&&s!==void 0?s:{});const{data:p,touched:h,errors:w,warnings:O,isDirty:N,isSubmitting:T,interacted:D}=e,k=Ae(p.update),C=Ae(h.update),S=Ae(w.update),Q=Ae(O.update);function G(u){k(y=>{const m=u(y);return a&&Re(a,m),m})}const _=(u,y,m)=>{Ae(G)(u,y),typeof u=="string"&&m&&C(u,!0)};function oe(u,y,m){const P=v(y)?de(y,!1):!1,L=v(P)?B(P,[]):[];y=v(y)?Object.assign(Object.assign({},y),{key:Qe()}):y,w.update(x=>je(x,u,L,m)),O.update(x=>je(x,u,L,m)),h.update(x=>je(x,u,P,m)),p.update(x=>{const J=je(x,u,y,m);return setTimeout(()=>a&&Re(a,J)),J})}function I(u){w.update(u),O.update(u),h.update(u),p.update(y=>{const m=u(y);return setTimeout(()=>a&&Re(a,m)),m})}function z(u){I(y=>Ie(y,u))}function V(u,y,m){I(P=>pt(P,u,y,m))}function ee(u,y,m){I(P=>bt(P,u,y,m))}function me(u){const y=fe(c,u),m=v(y)?de(y,!1):!1,P=v(m)?B(m,[]):[];p.update(L=>{const x=E(L,u,y);return a&&Re(a,x),x}),h.update(L=>E(L,u,m)),w.update(L=>E(L,u,P)),O.update(L=>E(L,u,P))}const b=Ae(T.update),M=Ae(N.update),te=Ae(D.update);async function ae(){const u=le(p);h.set(de(u,!0)),D.set(null);const y=await r(u);return await n(u),y}function ue(){_(K(c)),C(u=>B(u,!1)),D.set(null),N.set(!1)}function F(u){return async function(m){var P,L,x,J,ce,Ee,we;const{createErrorEvent:Pe,createSubmitEvent:Ne,createSuccessEvent:Se}=yt(),ne=Ne();a==null||a.dispatchEvent(ne);const l=(L=(P=ne.onError)!==null&&P!==void 0?P:u==null?void 0:u.onError)!==null&&L!==void 0?L:t.onError,o=(J=(x=ne.onSuccess)!==null&&x!==void 0?x:u==null?void 0:u.onSuccess)!==null&&J!==void 0?J:t.onSuccess,d=(we=(Ee=(ce=ne.onSubmit)!==null&&ce!==void 0?ce:u==null?void 0:u.onSubmit)!==null&&Ee!==void 0?Ee:t.onSubmit)!==null&&we!==void 0?we:vt(a);if(!d||(m==null||m.preventDefault(),ne.defaultPrevented))return;T.set(!0),D.set(null);const f=_e(le(p)),$=await r(f,u==null?void 0:u.validate),ve=await n(f,u==null?void 0:u.warn);if(ve&&O.set(Je(B(f,[]),ve)),h.set(de(f,!0)),$&&(h.set(de($,!0)),Le($,R=>Array.isArray(R)?R.length>=1:!!R))){await new Promise(R=>setTimeout(R)),i().forEach(R=>{var Y;return(Y=R.onSubmitError)===null||Y===void 0?void 0:Y.call(R,{data:f,errors:$})}),T.set(!1);return}const ie={event:m,setFields:_,setData:k,setTouched:C,setErrors:S,setWarnings:Q,unsetField:z,addField:oe,resetField:me,reset:ue,setInitialValues:re.setInitialValues,moveField:ee,swapFields:V,form:a,controls:a&&Array.from(a.elements).filter(U),config:Object.assign(Object.assign({},t),u)};try{const W=await d(f,ie);a==null||a.dispatchEvent(Se(Object.assign({response:W},ie))),await(o==null?void 0:o(W,ie))}catch(W){const R=Pe(Object.assign({error:W},ie));if(a==null||a.dispatchEvent(R),!l&&!R.defaultPrevented)throw W;if(!l&&!R.errors)return;const Y=R.errors||await(l==null?void 0:l(W,ie));Y&&(h.set(de(Y,!0)),w.set(Y),await new Promise(se=>setTimeout(se)),i().forEach(se=>{var pe;return(pe=se.onSubmitError)===null||pe===void 0?void 0:pe.call(se,{data:f,errors:le(w)})}))}finally{T.set(!1)}}}const re={setData:k,setFields:_,setTouched:C,setErrors:S,setWarnings:Q,setIsSubmitting:b,setIsDirty:M,setInteracted:te,validate:ae,reset:ue,unsetField:z,resetField:me,addField:oe,swapFields:V,moveField:ee,createSubmitHandler:F,handleSubmit:F(),setInitialValues:u=>{c=Te(u)}};return{public:re,private:{_setFormNode(u){a=u},_getInitialValues:()=>c}}}function ht({helpers:e,stores:t,config:r,extender:n,createSubmitHandler:i,handleSubmit:s,_setFormNode:a,_getInitialValues:c,_setCurrentExtenders:p,_getCurrentExtenders:h}){const{setFields:w,setTouched:O,reset:N,setInitialValues:T}=e,{addValidator:D,addTransformer:k,validate:C}=e,{data:S,errors:Q,warnings:G,touched:_,isSubmitting:oe,isDirty:I,interacted:z,isValid:V,isValidating:ee}=t;function me(b){b.requestSubmit||(b.requestSubmit=s);function M(l){return function(o){return o({form:b,stage:l,controls:Array.from(b.elements).filter(U),data:S,errors:Q,warnings:G,touched:_,isValid:V,isValidating:ee,isSubmitting:oe,isDirty:I,interacted:z,config:r,addValidator:D,addTransformer:k,setFields:w,validate:C,reset:N,createSubmitHandler:i,handleSubmit:s})}}p(n.map(M("MOUNT"))),b.noValidate=!!r.validate;const{defaultData:te,defaultTouched:ae}=Xe(b);a(b),T(Je(K(te),c())),w(c()),_.set(ae);function ue(l){const o=j(l),d=Array.from(b.querySelectorAll(`[name="${l.name}"]`)).filter(f=>U(f)?o===j(f):!1);if(d.length!==0)return d.length===1?S.update(f=>E(f,j(l),l.checked)):S.update(f=>E(f,j(l),d.filter(ke).filter($=>$.checked).map($=>$.value)))}function F(l){const o=b.querySelectorAll(`[name="${l.name}"]`),d=Array.from(o).find(f=>ke(f)&&f.checked);S.update(f=>E(f,j(l),d==null?void 0:d.value))}function re(l){var o;const d=Array.from((o=l.files)!==null&&o!==void 0?o:[]);S.update(f=>E(f,j(l),l.multiple?d:d[0]))}function ye(l){if(!l.multiple)S.update(o=>E(o,j(l),l.value));else{const o=Array.from(l.selectedOptions).map(d=>d.value);S.update(d=>E(d,j(l),o))}}function u(l){const o=l.target;if(!o||!U(o)||Fe(o)||Me(o)||["checkbox","radio","file"].includes(o.type)||!o.name)return;I.set(!0);const d=Ze(o);z.set(o.name),S.update(f=>E(f,j(o),d))}function y(l){const o=l.target;if(!(!o||!U(o)||Me(o))&&o.name)if(O(j(o),!0),z.set(o.name),(Fe(o)||["checkbox","radio","file","hidden"].includes(o.type))&&I.set(!0),o.type==="hidden"&&S.update(d=>E(d,j(o),o.value)),Fe(o))ye(o);else if(ke(o))o.type==="checkbox"?ue(o):o.type==="radio"?F(o):o.type==="file"&&re(o);else return}function m(l){const o=l.target;!o||!U(o)||Me(o)||o.name&&(O(j(o),!0),z.set(o.name))}function P(l){l.preventDefault(),N()}const L={childList:!0,subtree:!0};function x(l){let o=le(S),d=le(_),f=le(Q),$=le(G);for(const ve of l.reverse()){if(ve.hasAttribute("data-felte-keep-on-remove")&&ve.dataset.felteKeepOnRemove!=="false")continue;const ie=/.*(\[[0-9]+\]|\.[0-9]+)\.[^.]+$/;let W=j(ve);const R=le(_);if(ie.test(W)){const se=W.split(".").slice(0,-1).join("."),pe=fe(R,se);v(pe)&&Object.keys(pe).length<=1&&(W=se)}o=Ie(o,W),d=Ie(d,W),f=Ie(f,W),$=Ie($,W)}S.set(o),_.set(d),Q.set(f),G.set($)}const J=Ue(()=>{h().forEach(d=>{var f;return(f=d.destroy)===null||f===void 0?void 0:f.call(d)}),p(n.map(M("UPDATE")));const{defaultData:l,defaultTouched:o}=Xe(b);S.update(d=>Be(d,l)),_.update(d=>Be(d,o)),e.setFields(le(S))},0);let ce=[];const Ee=Ue(()=>{h().forEach(l=>{var o;return(o=l.destroy)===null||o===void 0?void 0:o.call(l)}),p(n.map(M("UPDATE"))),x(ce),ce=[]},0);function we(l){Array.from(l.addedNodes).some(d=>ze(d)?U(d)?!0:qe(d).length>0:!1)&&J()}function Pe(l){for(const o of l.removedNodes){if(!ze(o))continue;const d=qe(o);d.length!==0&&(ce.push(...d),Ee())}}function Ne(l){for(const o of l)o.type==="childList"&&(o.addedNodes.length>0&&we(o),o.removedNodes.length>0&&Pe(o))}const Se=new MutationObserver(Ne);Se.observe(b,L),b.addEventListener("input",u),b.addEventListener("change",y),b.addEventListener("focusout",m),b.addEventListener("submit",s),b.addEventListener("reset",P);const ne=Q.subscribe(l=>{for(const o of b.elements){if(!U(o)||!o.name)continue;const d=fe(l,j(o)),f=Array.isArray(d)?d.join(`
`):typeof d=="string"?d:void 0;f!==o.dataset.felteValidationMessage&&(f?(o.dataset.felteValidationMessage=f,o.setAttribute("aria-invalid","true")):(delete o.dataset.felteValidationMessage,o.removeAttribute("aria-invalid")))}});return{destroy(){Se.disconnect(),b.removeEventListener("input",u),b.removeEventListener("change",y),b.removeEventListener("focusout",m),b.removeEventListener("submit",s),b.removeEventListener("reset",P),ne(),h().forEach(l=>{var o;return(o=l.destroy)===null||o===void 0?void 0:o.call(l)})}}}return{form:me}}function Et(e){const t={aborted:!1,priority:e};return{signal:t,abort(){t.aborted=!0}}}function wt(e,t){if(v(e))return!t||v(t)&&Object.keys(t).length===0?B(e,null):void 0;if(Array.isArray(e)){if(e.some(v))return;const r=Array.isArray(t)?t:[];return e.map((n,i)=>{const s=r[i];return Array.isArray(s)&&s.length===0?null:n&&s||null})}return Array.isArray(t)&&t.length===0?null:Array.isArray(t)?e?t:null:e&&t?[t]:null}function St(e,t){if(v(e))return!t||v(t)&&Object.keys(t).length===0?B(e,null):void 0;if(Array.isArray(e)){if(e.some(v))return;const r=Array.isArray(t)?t:[];return e.map((n,i)=>{const s=r[i];return Array.isArray(s)&&s.length===0?null:s||null})}return Array.isArray(t)&&t.length===0?null:Array.isArray(t)?t:t?[t]:null}function gt([e,t]){return he(t,e,wt)}function Ot([e,t]){return he(t,e,St)}function _t(e){return function(r,n,i){const s=Array.isArray(r)?r:[r],a=new Array(s.length),c=e(i),p=c.set,h=c.subscribe;let w;function O(){w=s.map((T,D)=>T.subscribe(k=>{a[D]=k,p(n(a))}))}function N(){w==null||w.forEach(T=>T())}return c.subscribe=function(D){const k=h(D);return()=>{k()}},[c,O,N]}}function Tt(e,t){var r,n,i,s,a,c,p,h,w;const O=_t(e),N=t.initialValues=t.initialValues?Te($e(K(t.initialValues),t.transform)):{},T=de(_e(N),!1),D=e(T),k=e(0),[C,S,Q]=O([D,k],([g,A])=>Le(g,X=>!!X)&&A>=1,!1);delete C.set,delete C.update;function G(g){let A;return async function(X,Z,q,ge=!1){if(!q||!X)return;let be=Z&&Object.keys(Z).length>0?Z:B(X,[]);const Oe=Et(ge);if((!(A!=null&&A.signal.priority)||ge)&&(A==null||A.abort(),A=Oe),A.signal.priority&&!ge)return;k.update(xe=>xe+1);const Ke=ft(X,q);return Ke.forEach(async xe=>{const tt=await xe;Oe.signal.aborted||(be=De([be,tt]),g.set(be))}),await Promise.all(Ke),A=void 0,k.update(xe=>xe-1),be}}let _=B(T,[]);const oe=e(N),I=B(T,[]),z=e(I),V=e(K(I)),[ee,me,b]=O([z,V],De,K(I)),M=B(T,[]),te=e(M),ae=e(K(M)),[ue,F,re]=O([te,ae],De,K(M)),[ye,u,y]=O([ee,D],gt,K(I)),[m,P,L]=O([ue,D],Ot,K(M));let x=!1;const[J,ce,Ee]=O(ee,([g])=>{var A;return x?!Le(g,H=>Array.isArray(H)?H.length>=1:!!H):(x=!0,!t.validate&&!(!((A=t.debounced)===null||A===void 0)&&A.validate))},!t.validate&&!(!((r=t.debounced)===null||r===void 0)&&r.validate));delete J.set,delete J.update;const we=e(!1),Pe=e(!1),Ne=e(null),Se=G(z),ne=G(te),l=G(V),o=G(ae),d=Ue(l,(a=(i=(n=t.debounced)===null||n===void 0?void 0:n.validateTimeout)!==null&&i!==void 0?i:(s=t.debounced)===null||s===void 0?void 0:s.timeout)!==null&&a!==void 0?a:300,{onInit:()=>{k.update(g=>g+1)},onEnd:()=>{k.update(g=>g-1)}}),f=Ue(o,(w=(p=(c=t.debounced)===null||c===void 0?void 0:c.warnTimeout)!==null&&p!==void 0?p:(h=t.debounced)===null||h===void 0?void 0:h.timeout)!==null&&w!==void 0?w:300);async function $(g,A){var H;const X=_e(g),Z=Se(X,_,A??t.validate,!0);if(A)return Z;const q=l(X,_,(H=t.debounced)===null||H===void 0?void 0:H.validate,!0);return De(await Promise.all([Z,q]))}async function ve(g,A){var H;const X=_e(g),Z=ne(X,_,A??t.warn,!0);if(A)return Z;const q=o(X,_,(H=t.debounced)===null||H===void 0?void 0:H.warn,!0);return De(await Promise.all([Z,q]))}let ie=I,W=M;function R(){const g=oe.subscribe(q=>{var ge,be;const Oe=_e(q);Se(Oe,_,t.validate),ne(Oe,_,t.warn),d(Oe,_,(ge=t.debounced)===null||ge===void 0?void 0:ge.validate),f(Oe,_,(be=t.debounced)===null||be===void 0?void 0:be.warn)}),A=D.subscribe(q=>{_=B(q,[])}),H=ee.subscribe(q=>{ie=q}),X=ue.subscribe(q=>{W=q});me(),ce(),F(),u(),P(),S();function Z(){g(),y(),b(),re(),L(),Ee(),Q(),A(),H(),X()}return Z}function Y(g){z.set(g(ie)),V.set({})}function se(g){te.set(g(W)),ae.set({})}function pe(g){Y(()=>g)}function et(g){se(()=>g)}return ye.set=pe,ye.update=Y,m.set=et,m.update=se,{data:oe,errors:ye,warnings:m,touched:D,isValid:J,isSubmitting:we,isDirty:Pe,isValidating:C,interacted:Ne,validateErrors:$,validateWarnings:ve,cleanup:t.preventStoreStart?()=>{}:R(),start:R}}function Dt(e,t){var r,n;(r=e.extend)!==null&&r!==void 0||(e.extend=[]),(n=e.debounced)!==null&&n!==void 0||(e.debounced={}),e.validate&&!Array.isArray(e.validate)&&(e.validate=[e.validate]),e.debounced.validate&&!Array.isArray(e.debounced.validate)&&(e.debounced.validate=[e.debounced.validate]),e.transform&&!Array.isArray(e.transform)&&(e.transform=[e.transform]),e.warn&&!Array.isArray(e.warn)&&(e.warn=[e.warn]),e.debounced.warn&&!Array.isArray(e.debounced.warn)&&(e.debounced.warn=[e.debounced.warn]);function i(F,{debounced:re,level:ye}={debounced:!1,level:"error"}){var u;const y=ye==="error"?"validate":"warn";(u=e.debounced)!==null&&u!==void 0||(e.debounced={});const m=re?e.debounced:e;m[y]?m[y]=[...m[y],F]:m[y]=[F]}function s(F){e.transform?e.transform=[...e.transform,F]:e.transform=[F]}const a=Array.isArray(e.extend)?e.extend:[e.extend];let c=[];const p=()=>c,h=F=>{c=F},{isSubmitting:w,isValidating:O,data:N,errors:T,warnings:D,touched:k,isValid:C,isDirty:S,cleanup:Q,start:G,validateErrors:_,validateWarnings:oe,interacted:I}=Tt(t.storeFactory,e),z=N.update,V=N.set,ee=F=>z(re=>Te($e(F(re),e.transform))),me=F=>V(Te($e(F,e.transform)));N.update=ee,N.set=me;const b=At({extender:a,config:e,addValidator:i,addTransformer:s,validateErrors:_,validateWarnings:oe,_getCurrentExtenders:p,stores:{data:N,errors:T,warnings:D,touched:k,isValid:C,isValidating:O,isSubmitting:w,isDirty:S,interacted:I}}),{createSubmitHandler:M,handleSubmit:te}=b.public;c=a.map(F=>F({stage:"SETUP",errors:T,warnings:D,touched:k,data:N,isDirty:S,isValid:C,isValidating:O,isSubmitting:w,interacted:I,config:e,addValidator:i,addTransformer:s,setFields:b.public.setFields,reset:b.public.reset,validate:b.public.validate,handleSubmit:te,createSubmitHandler:M}));const ae=Object.assign({config:e,stores:{data:N,touched:k,errors:T,warnings:D,isSubmitting:w,isValidating:O,isValid:C,isDirty:S,interacted:I},createSubmitHandler:M,handleSubmit:te,helpers:Object.assign(Object.assign({},b.public),{addTransformer:s,addValidator:i}),extender:a,_getCurrentExtenders:p,_setCurrentExtenders:h},b.private),{form:ue}=ht(ae);return Object.assign({data:N,errors:T,warnings:D,touched:k,isValid:C,isSubmitting:w,isValidating:O,isDirty:S,interacted:I,form:ue,cleanup:Q,startStores:G},b.public)}function kt(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Nt(e){const t=Dt(e??{},{storeFactory:rt}),{cleanup:r,startStores:n}=t,i=kt(t,["cleanup","startStores"]);return nt(r),i}export{Nt as c};
